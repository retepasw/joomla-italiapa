tinymce.PluginManager.add("deflist",function(h,c){h.contentCSS.push(c+"/deflist.css");var g;var i=function(p,q){var o=p.settings.plugins?p.settings.plugins:"";return tinymce.util.Tools.inArray(o.split(/[ ,]/),q)!==-1};function n(o){return h.$.contains(h.getBody(),o)}function b(o){return o&&(/^(OL|UL|DL)$/).test(o.nodeName)&&n(o)}function e(p,o,r){function q(){var v,s,w={},t=0,u;s=h.dom.select("dt[data-mce-selected]");v=s[0];if(!v){v=h.selection.getStart()}if(r&&s.length>0){each(s,function(x){return w[x.parentNode.parentNode.nodeName]=1});each(w,function(x){t+=x});u=t!==1}else{u=!h.dom.getParent(v,o)}p.disabled(u);h.selection.selectorChanged(o,function(x){p.disabled(!x)})}if(h.initialized){q()}else{h.on("init",q)}}function a(){e(this,"dl.Accordion>dt:not([aria-selected=true])")}function l(){e(this,"dl.Accordion>dt[aria-selected=true]")}function f(q,o){var p=[];if(o){tinymce.util.Tools.each(o.split(/[ ,]/),function(r){p.push({text:r.replace(/\-/g," ").replace(/\b\w/g,function(s){return s.toUpperCase()}),data:r=="default"?"":r})});p.push({text:"-"});p.push({icon:"none icon-arrow-up",text:"Open",onclick:function(){h.undoManager.transact(function(){var r,t=h.dom,s=h.selection;r=t.getParent(s.getNode(),"dt");if(r&&r.nodeName=="DT"){t.setAttrib(r,"aria-selected","true")}})},onpostrender:a});p.push({icon:"none icon-arrow-down",text:"Close",onclick:function(){h.undoManager.transact(function(){var r,t=h.dom,s=h.selection;r=t.getParent(s.getNode(),"dt");if(r&&r.nodeName=="DT"){t.setAttrib(r,"aria-selected","")}})},onpostrender:l})}return p}var d="default,Accordion,Accordion--default,Accordion--plus,Timeline";g=f("DL",h.getParam("deflist_styles",d));function m(p,o){if(o==null){return}h.undoManager.transact(function(){var r,s=h.dom,q=h.selection;r=s.getParent(q.getNode(),"dl");if(!r||r.nodeName!=p||o===false){h.execCommand("InsertDefinitionList",false,null)}r=s.getParent(q.getNode(),"dl");if(r){tinymce.util.Tools.each(s.select("dl",r).concat([r]),function(t){if(t.nodeName!==p&&o!==false){t=s.rename(t,p)}tinymce.util.Tools.each(h.getParam("deflist_styles",d).split(/[ ,]/),function(u){s.removeClass(t,u)});if((o=="Accordion--default")||(o=="Accordion--plus")){s.addClass(t,"Accordion")}s.addClass(t,o)})}h.focus()})}function j(q){var r=h.dom,p=r.getParent(h.selection.getNode(),"dl");if(p){var o=null;q.control.items().each(function(s){s.active(false);if(s.settings.data){if(r.hasClass(p,s.settings.data)){o=s}}else{if(!o){o=s}}});o.active(true)}}var k=function(o){return function(){var p=this;h.on("NodeChange",function(r){var q=tinymce.util.Tools.grep(r.parents,b);p.active(q.length>0&&q[0].nodeName===o)})}};if(i(h,"lists")){h.addCommand("ApplyDefinitionListStyle",function(p,o){m("DL",false)});h.addButton("deflist",{type:(g.length>0)?"splitbutton":"button",tooltip:"Definition list",icon:"none icon-list-2",menu:g,onPostRender:k("DL"),onshow:j,onselect:function(o){m("DL",o.control.settings.data)},onclick:function(){m("DL",false)}});h.on("keyup",function(q){if(q.keyCode==13){var o,r=h.dom,p=h.selection;o=r.getParent(p.getNode(),"dt,dd");if(o){if(o.nodeName=="DT"){r.rename(o,"dd")}else{if(o.nodeName=="DD"){r.rename(o,"dt")}}}}})}});